<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="generator" content="Hugo 0.62.2" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,700" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/styles/github.min.css">
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/skeleton.css">
  <link rel="stylesheet" href="css/custom.css">
  <!-- <link rel="alternate" href="index.xml" type="application/rss+xml" title="PopMAG"> -->
  <link rel="shortcut icon" href="favicon.png" type="image/x-icon" />
  <title>Museformer: Transformer with Fine- and Coarse-Grained Attention for Music Generation</title>
</head>

<body>

  <div class="container">

    <header role="banner">

    </header>


    <main role="main">
      <article itemscope itemtype="https://schema.org/BlogPosting">
        <h1 class="entry-title" itemprop="headline">Museformer: Transformer with Fine- and Coarse-Grained Attention for
          Music Generation</h1>

        <section itemprop="entry-text">

          <div align="justify">
            <b>Abstract: </b>Music sequences are typically very long, e.g., with over 10,000 tokens, making them hard to
            model by Transformer due to its quadratic complexity of self-attention. Although there are many Transformer
            variants aiming at modeling long sequences in natural language processing, directly using them in music
            generation is suboptimal, because music has both short-term structures and long-term structures, which is
            very different from text. In this paper, we propose Museformer, a Transformer with a novel fine- and
            coarse-grained attention for symbolic music generation. Specifically, with fine-grained attention, a token
            of a specific bar directly attends to all the tokens of the bars that are most relevant in regard to music
            structures (e.g., the previous 1st, 2nd, 4th and 8th bars, selected based on musical knowledge); with
            coarse-grained attention, a token only attends to the summarization of the other bars rather than each token
            of them so as to reduce computational cost. The advantages of our model are two-fold. First, it can capture
            both music structure-related correlations via the fine-grained attention, and other contextual information
            via the coarse-grained attention. Second, it is efficient and can well model over 4X longer music sequences
            compared to its full-attention counterpart. Both objective and subjective experimental results demonstrate
            its ability to generate long music sequences with high quality and better structures. Our generated music
            samples can be found at <a href="https://museformer.github.io/">https://museformer.github.io/</a>.
          </div>

          <h2>Museformer</h2>
          <p>Here, we present several music pieces generated by Museformer. </p>
          <p>Museformer can generate music with better structures, which makes the generated music real, more like human-made music. Please watch the videos below for the details.</p>


          <h3>Demo 1  (<a href="midi/mf/mf_demo1.mid">midi</a>)</h3> 

          <video width="960" height="540" controls autoplay>
            <source src="video/mf_demo1.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="audio/mf/mf_demo1.mp3" autoplay />Your browser does not support the audio element.
          </audio>
          
          
          <h3>Demo 2  (<a href="midi/mf/mf_demo2.mid">midi</a>)</h3>

          <video width="960" height="540" controls autoplay>
            <source src="video/mf_demo2.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="audio/mf/mf_demo2.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h3>Demo 3  (<a href="midi/mf/mf_demo3.mid">midi</a>)</h3>

          <video width="960" height="540" controls autoplay>
            <source src="video/mf_demo3.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="audio/mf/mf_demo3.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h3>Demo 4  (<a href="midi/mf/mf_demo4.mid">midi</a>)</h3>

          <video width="960" height="540" controls autoplay>
            <source src="video/mf_demo4.mp4" type="video/mp4">
          </video>

          <audio controls="controls">
            <source src="audio/mf/mf_demo4.mp3" autoplay />Your browser does not support the audio element.
          </audio>


          <h2>Baseline Models</h2>
          <p>Here are music pieces generated by the baseline models:</p>

          <table>

            <tbody>
              <tr>
                <td style="text-align: left">Music Transformer</td>
                <td><audio controls="controls">
                    <source src="audio/mt/mt_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="midi/mt/mt_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Transformer-XL</td>
                <td><audio controls="controls">
                    <source src="audio/xl/xl_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="midi/xl/xl_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Longformer</td>
                <td><audio controls="controls">
                    <source src="audio/longformer/longformer_demo.mp3" autoplay />Your browser does not support the audio
                    element.
                  </audio></td>
                <td><a href="midi/longformer/longformer_demo.mid">midi</a></td>
              </tr>
              <tr>
                <td style="text-align: left">Linear Transformer</td>
                <td><audio controls="controls">
                    <source src="audio/linear/linear_demo.mp3" autoplay />Your browser does not support the audio element.
                  </audio></td>
                <td><a href="midi/linear/linear_demo.mid">midi</a></td>
              </tr>
            </tbody>
          </table>

          The baseline models can generate reasonable music with short-term structures though, they cannot generate the
          long-term structures. As you may see, there is no long-distance repetition in these samples.

          <br /><br />
          <p>Thank you &#128151;!</p>

        </section>
      </article>
    </main>




  </div>

  <script>
    (function (i, s, o, g, r, a, m) {
      i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
        (i[r].q = i[r].q || []).push(arguments)
      }, i[r].l = 1 * new Date(); a = s.createElement(o),
        m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
    })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
    ga('create', 'UA-139981676-1', 'auto');
    ga('send', 'pageview');
  </script>

  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/8.4/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>



  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
         HTML: ["input/TeX","output/HTML-CSS"],
         TeX: {
                Macros: {
                         bm: ["\\boldsymbol{#1}", 1],
                         argmax: ["\\mathop{\\rm arg\\,max}\\limits"],
                         argmin: ["\\mathop{\\rm arg\\,min}\\limits"]},
                extensions: ["AMSmath.js","AMSsymbols.js"],
                equationNumbers: { autoNumber: "AMS" } },
         extensions: ["tex2jax.js"],
         jax: ["input/TeX","output/HTML-CSS"],
         tex2jax: { inlineMath: [ ['$','$'], ["\\(","\\)"] ],
                    displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
                    processEscapes: true },
         "HTML-CSS": { availableFonts: ["TeX"],
                       linebreaks: { automatic: true } }
     });
 </script>

  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       tex2jax: {
         skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
       }
     });
 </script>

  <script type="text/javascript" async
    src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
    </script>




</body>

</html>